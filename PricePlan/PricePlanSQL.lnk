--first query PPS01 -Not created yet
 SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.TCOMITM_CAT_COD AS PROMIS, E.BEORDRIN, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID  FROM    STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CUSTOMER_DATA D, STHDSN6.TENA2.FPT8200 E  WHERE   A.CUST_PARTN_ID="!!gscustpartnid!!" AND     A.SBSCT_CUST_OID= "!!gscustoid!!" AND     B.CUST_PARTN_ID=A.CUST_PARTN_ID  AND     A.AGREE_OID=B.AGREE_OID  AND     D.CUST_PARTN_ID = A.CUST_PARTN_ID  AND     D.CUST_OID = A.SBSCT_CUST_OID  AND     A.TCOMITM_CAT_COD <> ''  AND DECIMAL(A.TCOMITM_CAT_COD) = E.PROMIS_ID UNION SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.TCOMITM_CAT_COD AS PROMIS, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID  FROM    STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CUSTOMER_DATA D  WHERE   A.CUST_PARTN_ID="!!gscustpartnid!!" AND     A.SBSCT_CUST_OID= "!!gscustoid!!" AND     B.CUST_PARTN_ID=A.CUST_PARTN_ID  AND     A.AGREE_OID=B.AGREE_OID  AND     D.CUST_PARTN_ID = A.CUST_PARTN_ID  AND     D.CUST_OID = A.SBSCT_CUST_OID  AND     A.TCOMITM_CAT_COD <> ''  AND NOT EXISTS  (SELECT * FROM STHDSN6.TENA2.FPT8200 E    WHERE DECIMAL(A.TCOMITM_CAT_COD) = E.PROMIS_ID) UNION  SELECT  A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.ASOC_ID AS PROMIS, E.BEORDRIN, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID  FROM    STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CUSTOMER_DATA D, STHDSN6.TENA2.FPT8200 E  WHERE    A.CUST_PARTN_ID="!!gscustpartnid!!" AND      A.SBSCT_CUST_OID= "!!gscustoid!!" AND      B.CUST_PARTN_ID=A.CUST_PARTN_ID  AND      A.AGREE_OID=B.AGREE_OID  AND      A.TCOMITM_CAT_COD = ''  AND      D.CUST_PARTN_ID = A.CUST_PARTN_ID  AND      D.CUST_OID = A.SBSCT_CUST_OID  AND      D.CUST_OID = A.SBSCT_CUST_OID  AND DECIMAL(A.ASOC_ID) = E.PROMIS_ID UNION  SELECT   A.SBSCT_ID,  A.SBSCT_STRTDT,  A.SBSCT_STOPDT,  A.ASOC_ID AS PROMIS,  E.TRT_VL,  A.GRP_TYPIND,  A.UPP_PLAN_TYP_IND,  A.RPROC_IND,  A.BOUTPT_LOC_IND,  A.INSTN_OID,  B.AGREE_ID,  D.PRSON_ORG_NM,  D.CURR_CUST_ID  FROM     STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A,  STHDSN6.TENGRA2.AGREEMENT_DATA B,  STHDSN6.TENGRA2.CUSTOMER_DATA D,  STHDSN6.TENGRA2.ASGND_TRT_TABL E  WHERE    A.CUST_PARTN_ID="!!gscustpartnid!!" AND      A.SBSCT_CUST_OID= "!!gscustoid!!" AND      B.CUST_PARTN_ID=A.CUST_PARTN_ID  AND      A.AGREE_OID=B.AGREE_OID  AND      A.TCOMITM_CAT_COD = ''  AND      D.CUST_PARTN_ID = A.CUST_PARTN_ID  AND      D.CUST_OID = A.SBSCT_CUST_OID  AND D.CUST_OID = A.SBSCT_CUST_OID  AND A.ASOC_ID = E.ASOC_ID UNION  SELECT   A.SBSCT_ID,  A.SBSCT_STRTDT,  A.SBSCT_STOPDT,  A.ASOC_ID AS PROMIS, A.GRP_TYPIND,  A.UPP_PLAN_TYP_IND,  A.RPROC_IND,  A.BOUTPT_LOC_IND,  A.INSTN_OID,  B.AGREE_ID,  D.PRSON_ORG_NM,  D.CURR_CUST_ID  FROM     STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A,  STHDSN6.TENGRA2.AGREEMENT_DATA B,  STHDSN6.TENGRA2.CUSTOMER_DATA D  WHERE    A.CUST_PARTN_ID="!!gscustpartnid!!" AND      A.SBSCT_CUST_OID= "!!gscustoid!!" AND      B.CUST_PARTN_ID=A.CUST_PARTN_ID  AND      A.AGREE_OID=B.AGREE_OID  AND      A.TCOMITM_CAT_COD = ''  AND      D.CUST_PARTN_ID = A.CUST_PARTN_ID  AND      D.CUST_OID = A.SBSCT_CUST_OID  AND      D.CUST_OID = A.SBSCT_CUST_OID  AND      NOT EXISTS  (SELECT * FROM STHDSN6.TENA2.FPT8200 E   WHERE DECIMAL(A.ASOC_ID) = E.PROMIS_ID)  AND      NOT EXISTS  (SELECT * FROM STHDSN6.TENGRA2.ASGND_TRT_TABL F   WHERE A.ASOC_ID = F.ASOC_ID)  ORDER BY  1 
 
 
 {
  "dburl": "http://131.116.44.144:1316/services/DB2ServiceManager",
  "username": "a472inb",
  "password": "INblatS2",
  "sqlStmt": "SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.TCOMITM_CAT_COD AS PROMIS, E.BEORDRIN, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM    STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CUSTOMER_DATA D, STHDSN6.TENA2.FPT8200 E WHERE   A.CUST_PARTN_ID=:CUST_PARTN_ID AND     A.SBSCT_CUST_OID=:SBSCT_CUST_OID AND     B.CUST_PARTN_ID=A.CUST_PARTN_ID AND     A.AGREE_OID=B.AGREE_OID AND     D.CUST_PARTN_ID = A.CUST_PARTN_ID AND     D.CUST_OID = A.SBSCT_CUST_OID AND     A.TCOMITM_CAT_COD <> '' AND DECIMAL(A.TCOMITM_CAT_COD) = E.PROMIS_ID UNION SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.TCOMITM_CAT_COD AS PROMIS, 'SAKNAS/AVVECKLAD', A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM    STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CUSTOMER_DATA D WHERE   A.CUST_PARTN_ID=:CUST_PARTN_ID AND     A.SBSCT_CUST_OID=:SBSCT_CUST_OID AND     B.CUST_PARTN_ID=A.CUST_PARTN_ID AND     A.AGREE_OID=B.AGREE_OID AND     D.CUST_PARTN_ID = A.CUST_PARTN_ID AND     D.CUST_OID = A.SBSCT_CUST_OID AND     A.TCOMITM_CAT_COD <> '' AND     NOT EXISTS (SELECT * FROM STHDSN6.TENA2..FPT8200 E WHERE DECIMAL(A.TCOMITM_CAT_COD) = E.PROMIS_ID) UNION SELECT  A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.ASOC_ID AS PROMIS, E.BEORDRIN, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM    STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CUSTOMER_DATA D, STHDSN6.TENA2..FPT8200 E WHERE    A.CUST_PARTN_ID=:CUST_PARTN_ID AND      A.SBSCT_CUST_OID=:SBSCT_CUST_OID AND      B.CUST_PARTN_ID=A.CUST_PARTN_ID AND      A.AGREE_OID=B.AGREE_OID AND      A.TCOMITM_CAT_COD = '' AND      D.CUST_PARTN_ID = A.CUST_PARTN_ID AND      D.CUST_OID = A.SBSCT_CUST_OID AND      D.CUST_OID = A.SBSCT_CUST_OID AND DECIMAL(A.ASOC_ID) = E.PROMIS_ID UNION SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.ASOC_ID AS PROMIS, E.TRT_VL, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM     STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CUSTOMER_DATA D, STHDSN6.TENGRA2.ASGND_TRT_TABL E WHERE    A.CUST_PARTN_ID=CUST_PARTN_ID AND      A.SBSCT_CUST_OID=:SBSCT_CUST_OID AND      B.CUST_PARTN_ID=A.CUST_PARTN_ID AND      A.AGREE_OID=B.AGREE_OID AND      A.TCOMITM_CAT_COD = '' AND      D.CUST_PARTN_ID = A.CUST_PARTN_ID AND      D.CUST_OID = A.SBSCT_CUST_OID AND      D.CUST_OID = A.SBSCT_CUST_OID AND      A.ASOC_ID = E.ASOC_ID UNION SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.ASOC_ID AS PROMIS, 'SAKNAS/AVVECKLAD', A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM     STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CUSTOMER_DATA D WHERE    A.CUST_PARTN_ID=:CUST_PARTN_ID AND      A.SBSCT_CUST_OID=:SBSCT_CUST_OID AND      B.CUST_PARTN_ID=A.CUST_PARTN_ID AND      A.AGREE_OID=B.AGREE_OID AND      A.TCOMITM_CAT_COD = '' AND      D.CUST_PARTN_ID = A.CUST_PARTN_ID AND      D.CUST_OID = A.SBSCT_CUST_OID AND      D.CUST_OID = A.SBSCT_CUST_OID AND      NOT EXISTS (SELECT * FROM STHDSN6.TENA2..FPT8200 E WHERE DECIMAL(A.ASOC_ID) = E.PROMIS_ID) AND      NOT EXISTS (SELECT * FROM STHDSN6.TENGRA2.ASGND_TRT_TABL F WHERE A.ASOC_ID = F.ASOC_ID) ORDER BY  1",
  "collectionID": "SYSIBMSERVICE",
  "serviceName": "PPS01",
  "description": "PPS01 based on   CUST_PARTN_ID  AND SBSCT_CUST_OID",
  "requestType": "createService",
  "version": "V1",
  "response": ""
}


 --pps04:--created with curl
SELECT A.INTVL_START_DATE, A.INTVL_STOP_DATE, B.CNUM_ID, A.CNTRB_ELIG_IND, A.MAIN_CNTX_VL, A.OPER_IND FROM STHDSN6.TENGRA2.CNUM_UPPS_DATA A, STHDSN6.TENGRA2.CNUM_ID_HIST_DATA B, STHDSN6.TENGRA2.CUST_ID_HIST_DATA C WHERE C.CUST_ID=:CUST_ID AND A.SBSCT_CUST_OID=C.CUST_OID AND B.CURR_CUST_PARTN_ID=A.CNUM_CUST_PARTN_ID AND A.CNUM_OID=B.CNUM_OID AND A.SBSCT_ID=:SBSCT_ID AND B.INTVL_START_DATE=(SELECT MAX(INTVL_START_DATE) FROM STHDSN6.TENGRA2.CNUM_ID_HIST_DATA WHERE CURR_CUST_PARTN_ID=B.CURR_CUST_PARTN_ID AND CNUM_OID=B.CNUM_OID) ORDER BY B.CNUM_ID ASC      
--pps02:              
       
  SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.TCOMITM_CAT_COD AS PROMIS, E.BEORDRIN, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM     STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CNUM_UPPS_DATA C, STHDSN6.TENGRA2.CUSTOMER_DATA D, STHDSN6.TENA2.FPT8200 E WHERE    C.CNUM_CUST_PARTN_ID = "!!gscustpartnid!!" AND      C.CNUM_OID = "!!gscharoid!!" AND      A.CUST_PARTN_ID=C.CUR_SBTCST_PRTN_ID AND      A.SBSCT_CUST_OID= C.SBSCT_CUST_OID AND      A.SBSCT_ID = C.SBSCT_ID AND      B.CUST_PARTN_ID=A.CUST_PARTN_ID AND      A.AGREE_OID=B.AGREE_OID AND      A.TCOMITM_CAT_COD <> '' AND      D.CUST_PARTN_ID = A.CUST_PARTN_ID AND      D.CUST_OID = A.SBSCT_CUST_OID AND DECIMAL(A.TCOMITM_CAT_COD) = E.PROMIS_ID  UNION SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.TCOMITM_CAT_COD AS PROMIS, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM     STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CNUM_UPPS_DATA C, STHDSN6.TENGRA2.CUSTOMER_DATA D WHERE    C.CNUM_CUST_PARTN_ID = "!!gscustpartnid!!" AND      C.CNUM_OID = "!!gscharoid!!" AND      A.CUST_PARTN_ID=C.CUR_SBTCST_PRTN_ID AND      A.SBSCT_CUST_OID= C.SBSCT_CUST_OID AND      A.SBSCT_ID = C.SBSCT_ID AND      B.CUST_PARTN_ID=A.CUST_PARTN_ID AND      A.AGREE_OID=B.AGREE_OID AND      A.TCOMITM_CAT_COD <> '' AND      D.CUST_PARTN_ID = A.CUST_PARTN_ID AND      D.CUST_OID = A.SBSCT_CUST_OID AND      NOT EXISTS (SELECT * FROM STHDSN6.TENA2.FPT8200 E  WHERE DECIMAL(A.TCOMITM_CAT_COD) = E.PROMIS_ID) UNION SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.ASOC_ID AS PROMIS, E.BEORDRIN, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM     STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CNUM_UPPS_DATA C, STHDSN6.TENGRA2.CUSTOMER_DATA D, STHDSN6.TENA2.FPT8200 E WHERE    C.CNUM_CUST_PARTN_ID = "!!gscustpartnid!!" AND      C.CNUM_OID = "!!gscharoid!!" AND      A.CUST_PARTN_ID=C.CUR_SBTCST_PRTN_ID AND      A.SBSCT_CUST_OID= C.SBSCT_CUST_OID AND      A.SBSCT_ID = C.SBSCT_ID AND      B.CUST_PARTN_ID=A.CUST_PARTN_ID AND      A.AGREE_OID=B.AGREE_OID AND      A.TCOMITM_CAT_COD = '' AND      D.CUST_PARTN_ID = A.CUST_PARTN_ID AND      D.CUST_OID = A.SBSCT_CUST_OID AND DECIMAL(A.ASOC_ID) = E.PROMIS_ID UNION SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.ASOC_ID AS PROMIS, E.TRT_VL, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM     STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CNUM_UPPS_DATA C, STHDSN6.TENGRA2.CUSTOMER_DATA D, STHDSN6.TENGRA2.ASGND_TRT_TABL E WHERE     C.CNUM_CUST_PARTN_ID = "!!gscustpartnid!!" AND       C.CNUM_OID = "!!gscharoid!!" AND       A.CUST_PARTN_ID=C.CUR_SBTCST_PRTN_ID AND       A.SBSCT_CUST_OID= C.SBSCT_CUST_OID AND       A.SBSCT_ID = C.SBSCT_ID AND       B.CUST_PARTN_ID=A.CUST_PARTN_ID AND       A.AGREE_OID=B.AGREE_OID AND       A.TCOMITM_CAT_COD = '' AND       D.CUST_PARTN_ID = A.CUST_PARTN_ID AND       D.CUST_OID = A.SBSCT_CUST_OID AND       A.ASOC_ID = E.ASOC_ID UNION SELECT   A.SBSCT_ID, A.SBSCT_STRTDT, A.SBSCT_STOPDT, A.ASOC_ID AS PROMIS, A.GRP_TYPIND, A.UPP_PLAN_TYP_IND, A.RPROC_IND, A.BOUTPT_LOC_IND, A.INSTN_OID, B.AGREE_ID, D.PRSON_ORG_NM, D.CURR_CUST_ID FROM     STHDSN6.TENGRA2.USAG_PPSCPTN_DATA A, STHDSN6.TENGRA2.AGREEMENT_DATA B, STHDSN6.TENGRA2.CNUM_UPPS_DATA C, STHDSN6.TENGRA2.CUSTOMER_DATA D WHERE     C.CNUM_CUST_PARTN_ID = "!!gscustpartnid!!" AND       C.CNUM_OID = "!!gscharoid!!" AND       A.CUST_PARTN_ID=C.CUR_SBTCST_PRTN_ID AND       A.SBSCT_CUST_OID= C.SBSCT_CUST_OID AND       A.SBSCT_ID = C.SBSCT_ID AND       B.CUST_PARTN_ID=A.CUST_PARTN_ID AND       A.AGREE_OID=B.AGREE_OID AND       A.TCOMITM_CAT_COD = '' AND       D.CUST_PARTN_ID = A.CUST_PARTN_ID AND       D.CUST_OID = A.SBSCT_CUST_OID AND       NOT EXISTS (SELECT * FROM STHDSN6.TENA2.FPT8200 E  WHERE DECIMAL(A.ASOC_ID) = E.PROMIS_ID) AND       NOT EXISTS (SELECT * FROM STHDSN6.TENGRA2.ASGND_TRT_TABL F  WHERE A.ASOC_ID = F.ASOC_ID) ORDER BY  1 
--  pps05:              
       
SELECT    A.INTVL_START_DATE, A.INTVL_STOP_DATE, B.CNUM_ID, A.CNTRB_ELIG_IND, A.MAIN_CNTX_VL, A.OPER_IND FROM      STHDSN6.TENGRA2.CNUM_UPPS_DATA A, STHDSN6.TENGRA2.CNUM_ID_HIST_DATA B, STHDSN6.TENGRA2.CUST_ID_HIST_DATA C WHERE      C.CUST_ID='"!!sagreecustid!!"' AND        A.SBSCT_CUST_OID=C.CUST_OID AND        B.CURR_CUST_PARTN_ID=A.CNUM_CUST_PARTN_ID AND        A.CNUM_OID=B.CNUM_OID AND        B.CNUM_OID = "!!gscharoid!!" AND        A.SBSCT_ID="!!ssbsctid!!" AND        B.INTVL_START_DATE=(SELECT MAX(INTVL_START_DATE)  FROM STHDSN6.TENGRA2.CNUM_ID_HIST_DATA  WHERE CURR_CUST_PARTN_ID=B.CURR_CUST_PARTN_ID  AND CNUM_OID=B.CNUM_OID) ORDER BY B.CNUM_ID ASC        

--des01:              
   
SELECT A.INTVL_START_DATE, A.INTVL_STOP_DATE, A.BEGIN_POINT_VL, A.END_POINT_VL, A.POINT_VL_LEN FROM STHDSN6.TENGRA2.SLCT_DEST_DATA A, STHDSN6.TENGRA2.CUST_ID_HIST_DATA B WHERE B.CUST_ID = '"!!sagreecustid!!"' AND A.CUST_PARTN_ID = B.CUST_PARTN_ID AND A.SBSCT_CUST_OID = B.CUST_OID AND SBSCT_ID = "!!ssbsctid!!" ORDER BY INTVL_START_DATE DESC              
--des02: 
SELECT DISTINCT A.INTVL_START_DATE, A.INTVL_STOP_DATE, SUBSTR(A.SEL_AREA_VL,1,6) CONCAT C.DSCR_TXT AS COUNTRY, A.AREA_TYPIND FROM STHDSN6.TENGRA2.SLCT_AREA_DATA A,    STHDSN6.TENGRA2.CUST_ID_HIST_DATA B,    STHDSN6.TENGRA2.CTRY_GP_TRM_TABL C WHERE B.CUST_ID = '"!!sagreecustid!!"' AND A.CUST_PARTN_ID = B.CUST_PARTN_ID AND A.SBSCT_CUST_OID = B.CUST_OID AND SBSCT_ID = "!!ssbsctid!!" AND A.AREA_TYPIND = 'L' AND C.LAND_ID = DECIMAL(A.SEL_AREA_VL) UNION SELECT    A.INTVL_START_DATE, A.INTVL_STOP_DATE, A.SEL_AREA_VL AS COUNTRY , A.AREA_TYPIND FROM STHDSN6.TENGRA2.SLCT_AREA_DATA A,    STHDSN6.TENGRA2.CUST_ID_HIST_DATA B WHERE B.CUST_ID = '"!!sagreecustid!!"' AND A.CUST_PARTN_ID = B.CUST_PARTN_ID AND A.SBSCT_CUST_OID= B.CUST_OID AND SBSCT_ID = "!!ssbsctid!!" AND A.AREA_TYPIND <> 'L' ORDER BY INTVL_START_DATE DESC,COUNTRY 
--des03:
 SELECT     A.INTVL_START_DATE, A.INTVL_STOP_DATE, A.SEL_CAT_COD FROM STHDSN6.TENGRA2.SLCT_CAT_DATA A, STHDSN6.TENGRA2.CUST_ID_HIST_DATA B WHERE B.CUST_ID = '"!!sagreecustid!!"' AND A.CUST_PARTN_ID = B.CUST_PARTN_ID AND A.SBSCT_CUST_OID = B.CUST_OID AND SBSCT_ID = "!!ssbsctid!!" ORDER BY INTVL_START_DATE DESC 
 --
 ADDRESS 'SQL'                                                                   
 "OPTIONS PLAN(SWSC1010) SUBSYS("db2sys")                         "             
 "  SELECT     A.INTVL_START_DATE,                                ",            
 "             A.INTVL_STOP_DATE,                                 ",            
 "             A.SEL_CAT_COD                                      ",            
 "  INTO      :KAINTVLSTARTDATE,                                  ",            
 "            :KAINTVLSTOPDATE,                                   ",            
 "            :SELCATCOD                                          ",            
 "  FROM      "!!tbowner!!".SLCT_CAT_DATA A,                      ",            
 "            "!!tbowner!!".CUST_ID_HIST_DATA B                   ",            
 "  WHERE      B.CUST_ID = '"!!sagreecustid!!"'                   ",            
 "  AND        A.CUST_PARTN_ID = B.CUST_PARTN_ID                  ",            
 "  AND        A.SBSCT_CUST_OID = B.CUST_OID                      ",            
 "  AND        SBSCT_ID = "!!ssbsctid!!"                          ",            
 "  ORDER BY INTVL_START_DATE DESC                                ",            
 "  FOR FETCH ONLY;  